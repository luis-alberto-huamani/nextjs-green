{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport React, { Component } from 'react';\nimport Layout from '../components/layout/layout';\nimport './foo.scss';\nimport Header from '../components/perf/header';\nimport Quote from '../components/perf/quote';\nimport uuid from 'uuid/v1';\nimport axios from 'axios';\nimport { Modal, ModalBody, Button } from 'reactstrap';\n\nvar Perfil =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Perfil, _Component);\n\n  function Perfil(props) {\n    var _this;\n\n    _classCallCheck(this, Perfil);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Perfil).call(this, props));\n    _this.state = {\n      id: '',\n      perfilImg: '',\n      perfilLoader: false,\n      fullName: '',\n      frontPageQuote: '',\n      frontPageImg: '',\n      frontPageLoader: false,\n      quoteVisible: false,\n      owner: null,\n      friendReqLoader: false,\n      friendReqSent: '',\n      confirmationMsg: false\n    };\n    _this.handleChange = _this.handleChange.bind(_assertThisInitialized(_this));\n    _this.handleChangeImg = _this.handleChangeImg.bind(_assertThisInitialized(_this));\n    _this.onQuote = _this.onQuote.bind(_assertThisInitialized(_this));\n    _this.onFriendReq = _this.onFriendReq.bind(_assertThisInitialized(_this));\n    _this.accpetFriend = _this.accpetFriend.bind(_assertThisInitialized(_this));\n    _this.cancelFriendReq = _this.cancelFriendReq.bind(_assertThisInitialized(_this));\n    _this.onConfirmation = _this.onConfirmation.bind(_assertThisInitialized(_this));\n    _this.rmFriend = _this.rmFriend.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Perfil, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      var user = this.props.user;\n      var fullName = \"\".concat(user.name, \" \").concat(user.lastName);\n      this.setState({\n        id: user.id,\n        perfilImg: user.perfilImg,\n        fullName: fullName,\n        frontPageQuote: user.frontPageQuote,\n        frontPageImg: user.frontPageImg,\n        owner: user.owner,\n        friendReqSent: user.friend\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      console.log(this.props.user);\n    }\n  }, {\n    key: \"handleChange\",\n    value: function handleChange(e) {\n      this.setState(_defineProperty({}, e.target.id, e.target.value));\n    }\n  }, {\n    key: \"handleChangeImg\",\n    value: function handleChangeImg(e) {\n      var _this2 = this;\n\n      var img = e.target.files[0];\n      var formData = new FormData();\n      var stateImg = \"\".concat(e.target.id, \"Img\");\n      var loader = \"\".concat(e.target.id, \"Loader\");\n      formData.append('file', img);\n\n      if (img) {\n        var options = {\n          method: \"POST\",\n          body: formData\n        };\n        this.setState(_defineProperty({}, loader, true));\n        fetch(\"/api/upload/\".concat(stateImg), options).then(function (res) {\n          if (res.status === 200) {\n            res.text().then(function (resp) {\n              var _this2$setState;\n\n              _this2.setState((_this2$setState = {}, _defineProperty(_this2$setState, stateImg, resp), _defineProperty(_this2$setState, loader, false), _this2$setState));\n            });\n          }\n        });\n      }\n    }\n  }, {\n    key: \"accpetFriend\",\n    value: function () {\n      var _accpetFriend = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(e) {\n        var targetId;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.setState({\n                  friendReqLoader: true\n                });\n                _context.prev = 1;\n                targetId = e.target.id;\n                _context.next = 5;\n                return axios.get(\"/aceptFriend/\".concat(targetId));\n\n              case 5:\n                this.setState({\n                  friendReqSent: 'accepted',\n                  friendReqLoader: false\n                });\n                _context.next = 11;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](1);\n                console.log(_context.t0);\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[1, 8]]);\n      }));\n\n      function accpetFriend(_x) {\n        return _accpetFriend.apply(this, arguments);\n      }\n\n      return accpetFriend;\n    }()\n  }, {\n    key: \"onQuote\",\n    value: function onQuote() {\n      var quoteVisible = this.state.quoteVisible;\n      this.setState({\n        quoteVisible: !quoteVisible\n      });\n    }\n  }, {\n    key: \"onFriendReq\",\n    value: function () {\n      var _onFriendReq = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(e) {\n        var id, response;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.setState({\n                  friendReqLoader: true\n                });\n                _context2.prev = 1;\n                id = this.state.id;\n                _context2.next = 5;\n                return axios.get(\"/sendFriendReq/\".concat(id));\n\n              case 5:\n                response = _context2.sent;\n                this.setState({\n                  friendReqLoader: false,\n                  friendReqSent: 'sent'\n                });\n                _context2.next = 12;\n                break;\n\n              case 9:\n                _context2.prev = 9;\n                _context2.t0 = _context2[\"catch\"](1);\n                console.log(_context2.t0);\n\n              case 12:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[1, 9]]);\n      }));\n\n      function onFriendReq(_x2) {\n        return _onFriendReq.apply(this, arguments);\n      }\n\n      return onFriendReq;\n    }()\n  }, {\n    key: \"cancelFriendReq\",\n    value: function () {\n      var _cancelFriendReq = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3() {\n        var id;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.prev = 0;\n                id = this.state.id;\n                _context3.next = 4;\n                return axios.get(\"/cancelFriendReq/\".concat(id));\n\n              case 4:\n                this.setState({\n                  friendReqSent: ''\n                });\n                _context3.next = 10;\n                break;\n\n              case 7:\n                _context3.prev = 7;\n                _context3.t0 = _context3[\"catch\"](0);\n                console.log(_context3.t0);\n\n              case 10:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[0, 7]]);\n      }));\n\n      function cancelFriendReq() {\n        return _cancelFriendReq.apply(this, arguments);\n      }\n\n      return cancelFriendReq;\n    }()\n  }, {\n    key: \"onConfirmation\",\n    value: function onConfirmation() {\n      this.setState({\n        confirmationMsg: !this.state.confirmationMsg\n      });\n    }\n  }, {\n    key: \"rmFriend\",\n    value: function () {\n      var _rmFriend = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4() {\n        var id;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.prev = 0;\n                id = this.state.id;\n                _context4.next = 4;\n                return axios.get(\"/rmFriend/\".concat(id));\n\n              case 4:\n                this.setState({\n                  friendReqSent: '',\n                  confirmationMsg: !this.state.confirmationMsg\n                });\n                _context4.next = 10;\n                break;\n\n              case 7:\n                _context4.prev = 7;\n                _context4.t0 = _context4[\"catch\"](0);\n                console.log(_context4.t0);\n\n              case 10:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[0, 7]]);\n      }));\n\n      function rmFriend() {\n        return _rmFriend.apply(this, arguments);\n      }\n\n      return rmFriend;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          id = _this$state.id,\n          perfilImg = _this$state.perfilImg,\n          perfilLoader = _this$state.perfilLoader,\n          fullName = _this$state.fullName,\n          quoteVisible = _this$state.quoteVisible,\n          frontPageQuote = _this$state.frontPageQuote,\n          frontPageImg = _this$state.frontPageImg,\n          frontPageLoader = _this$state.frontPageLoader,\n          owner = _this$state.owner,\n          friendReqLoader = _this$state.friendReqLoader,\n          friendReqSent = _this$state.friendReqSent,\n          confirmationMsg = _this$state.confirmationMsg;\n      return React.createElement(Layout, null, React.createElement(Quote, {\n        isOpen: quoteVisible,\n        onQuote: this.onQuote,\n        handleChange: this.handleChange,\n        quote: frontPageQuote,\n        owner: owner\n      }), React.createElement(Modal, {\n        isOpen: confirmationMsg\n      }, React.createElement(ModalBody, null, React.createElement(\"div\", {\n        className: \"confirmation_cont\"\n      }, React.createElement(\"p\", null, \"Seguro que desea eliminar a \", React.createElement(\"span\", null, fullName)), React.createElement(\"div\", {\n        className: \"confirmation_btn_cont\"\n      }, React.createElement(Button, {\n        size: \"sm\",\n        onClick: this.onConfirmation,\n        color: \"secondary\"\n      }, \"No\"), React.createElement(Button, {\n        size: \"sm\",\n        onClick: this.rmFriend,\n        color: \"success\"\n      }, \"Si\"))))), React.createElement(Header, {\n        user: {\n          id: id,\n          perfilImg: perfilImg,\n          fullName: fullName,\n          frontPageImg: frontPageImg,\n          frontPageQuote: frontPageQuote,\n          friendReqSent: friendReqSent\n        },\n        owner: owner,\n        frontPageLoader: frontPageLoader,\n        perfilLoader: perfilLoader,\n        friendReqLoader: friendReqLoader,\n        action: {\n          onQuote: this.onQuote,\n          handleChangeImg: this.handleChangeImg,\n          onFriendReq: this.onFriendReq,\n          accpetFriend: this.accpetFriend,\n          cancelFriendReq: this.cancelFriendReq,\n          onConfirmation: this.onConfirmation\n        }\n      }), React.createElement(\"div\", {\n        className: \"void_space\"\n      }));\n    }\n  }]);\n\n  return Perfil;\n}(Component);\n\n_defineProperty(Perfil, \"getInitialProps\", function (_ref) {\n  var query = _ref.query;\n  var user = query.user;\n  return {\n    user: user\n  };\n});\n\nexport default Perfil;","map":null,"metadata":{},"sourceType":"module"}