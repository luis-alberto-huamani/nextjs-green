{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport React, { Component } from 'react';\nimport Layout from '../components/layout/layout';\nimport './foo.scss';\nimport Header from '../components/perf/header';\nimport Quote from '../components/perf/quote';\nimport uuid from 'uuid/v1';\nimport axios from 'axios';\nimport { Modal, ModalBody, Button } from 'reactstrap';\n\nvar Perfil =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Perfil, _Component);\n\n  function Perfil(props) {\n    var _this;\n\n    _classCallCheck(this, Perfil);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Perfil).call(this, props));\n    _this.state = {\n      id: '',\n      perfilImg: '',\n      perfilLoader: false,\n      fullName: '',\n      frontPageQuote: '',\n      frontPageImg: '',\n      frontPageLoader: false,\n      quoteVisible: false,\n      owner: null,\n      friendReqLoader: false,\n      friendReqSent: '',\n      confirmationMsg: false\n    };\n    _this.handleChange = _this.handleChange.bind(_assertThisInitialized(_this));\n    _this.handleChangeImg = _this.handleChangeImg.bind(_assertThisInitialized(_this));\n    _this.onQuote = _this.onQuote.bind(_assertThisInitialized(_this));\n    _this.onFriendReq = _this.onFriendReq.bind(_assertThisInitialized(_this));\n    _this.accpetFriend = _this.accpetFriend.bind(_assertThisInitialized(_this));\n    _this.cancelFriendReq = _this.cancelFriendReq.bind(_assertThisInitialized(_this));\n    _this.onConfirmation = _this.onConfirmation.bind(_assertThisInitialized(_this));\n    _this.rmFriend = _this.rmFriend.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Perfil, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      var user = this.props.user;\n      var fullName = \"\".concat(user.name, \" \").concat(user.lastName);\n      this.setState({\n        id: user.id,\n        perfilImg: user.perfilImg,\n        fullName: fullName,\n        frontPageQuote: user.frontPageQuote,\n        frontPageImg: user.frontPageImg,\n        owner: user.owner,\n        friendReqSent: user.friend\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      console.log(this.props.user);\n    }\n  }, {\n    key: \"handleChange\",\n    value: function handleChange(e) {\n      this.setState(_defineProperty({}, e.target.id, e.target.value));\n    }\n  }, {\n    key: \"handleChangeImg\",\n    value: function handleChangeImg(e) {\n      var _this2 = this;\n\n      var img = e.target.files[0];\n      var formData = new FormData();\n      var stateImg = \"\".concat(e.target.id, \"Img\");\n      var loader = \"\".concat(e.target.id, \"Loader\");\n      formData.append('file', img);\n\n      if (img) {\n        var options = {\n          method: \"POST\",\n          body: formData\n        };\n        this.setState(_defineProperty({}, loader, true));\n        fetch(\"/api/upload/\".concat(stateImg), options).then(function (res) {\n          if (res.status === 200) {\n            res.text().then(function (resp) {\n              var _this2$setState;\n\n              _this2.setState((_this2$setState = {}, _defineProperty(_this2$setState, stateImg, resp), _defineProperty(_this2$setState, loader, false), _this2$setState));\n            });\n          }\n        });\n      }\n    }\n  }, {\n    key: \"accpetFriend\",\n    value: function () {\n      var _accpetFriend = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(e) {\n        var targetId;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.setState({\n                  friendReqLoader: true\n                });\n                _context.prev = 1;\n                targetId = e.target.id;\n                _context.next = 5;\n                return axios.get(\"/aceptFriend/\".concat(targetId));\n\n              case 5:\n                this.setState({\n                  friendReqSent: 'accepted',\n                  friendReqLoader: false\n                });\n                _context.next = 11;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](1);\n                console.log(_context.t0);\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[1, 8]]);\n      }));\n\n      function accpetFriend(_x) {\n        return _accpetFriend.apply(this, arguments);\n      }\n\n      return accpetFriend;\n    }()\n  }, {\n    key: \"onQuote\",\n    value: function onQuote() {\n      var quoteVisible = this.state.quoteVisible;\n      this.setState({\n        quoteVisible: !quoteVisible\n      });\n    }\n  }, {\n    key: \"onFriendReq\",\n    value: function () {\n      var _onFriendReq = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(e) {\n        var id, response;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.setState({\n                  friendReqLoader: true\n                });\n                _context2.prev = 1;\n                id = this.state.id;\n                _context2.next = 5;\n                return axios.get(\"/sendFriendReq/\".concat(id));\n\n              case 5:\n                response = _context2.sent;\n                this.setState({\n                  friendReqLoader: false,\n                  friendReqSent: 'sent'\n                });\n                _context2.next = 12;\n                break;\n\n              case 9:\n                _context2.prev = 9;\n                _context2.t0 = _context2[\"catch\"](1);\n                console.log(_context2.t0);\n\n              case 12:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[1, 9]]);\n      }));\n\n      function onFriendReq(_x2) {\n        return _onFriendReq.apply(this, arguments);\n      }\n\n      return onFriendReq;\n    }()\n  }, {\n    key: \"cancelFriendReq\",\n    value: function () {\n      var _cancelFriendReq = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3() {\n        var id;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.prev = 0;\n                id = this.state.id;\n                _context3.next = 4;\n                return axios.get(\"/cancelFriendReq/\".concat(id));\n\n              case 4:\n                this.setState({\n                  friendReqSent: ''\n                });\n                _context3.next = 10;\n                break;\n\n              case 7:\n                _context3.prev = 7;\n                _context3.t0 = _context3[\"catch\"](0);\n                console.log(_context3.t0);\n\n              case 10:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[0, 7]]);\n      }));\n\n      function cancelFriendReq() {\n        return _cancelFriendReq.apply(this, arguments);\n      }\n\n      return cancelFriendReq;\n    }()\n  }, {\n    key: \"onConfirmation\",\n    value: function onConfirmation() {\n      this.setState({\n        confirmationMsg: !this.state.confirmationMsg\n      });\n    }\n  }, {\n    key: \"rmFriend\",\n    value: function () {\n      var _rmFriend = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4() {\n        var id;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.prev = 0;\n                id = this.state.id;\n                _context4.next = 4;\n                return axios.get(\"/rmFriend/\".concat(id));\n\n              case 4:\n                this.setState({\n                  friendReqSent: '',\n                  confirmationMsg: !this.state.confirmationMsg\n                });\n                _context4.next = 10;\n                break;\n\n              case 7:\n                _context4.prev = 7;\n                _context4.t0 = _context4[\"catch\"](0);\n                console.log(_context4.t0);\n\n              case 10:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[0, 7]]);\n      }));\n\n      function rmFriend() {\n        return _rmFriend.apply(this, arguments);\n      }\n\n      return rmFriend;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          id = _this$state.id,\n          perfilImg = _this$state.perfilImg,\n          perfilLoader = _this$state.perfilLoader,\n          fullName = _this$state.fullName,\n          quoteVisible = _this$state.quoteVisible,\n          frontPageQuote = _this$state.frontPageQuote,\n          frontPageImg = _this$state.frontPageImg,\n          frontPageLoader = _this$state.frontPageLoader,\n          owner = _this$state.owner,\n          friendReqLoader = _this$state.friendReqLoader,\n          friendReqSent = _this$state.friendReqSent,\n          confirmationMsg = _this$state.confirmationMsg;\n      return React.createElement(Layout, null, React.createElement(Quote, {\n        isOpen: quoteVisible,\n        onQuote: this.onQuote,\n        handleChange: this.handleChange,\n        quote: frontPageQuote,\n        owner: owner\n      }), React.createElement(Modal, {\n        isOpen: confirmationMsg\n      }, React.createElement(ModalBody, null, React.createElement(\"div\", {\n        className: \"confirmation_cont\"\n      }, React.createElement(\"p\", null, \"Seguro que desea eliminar a \", fullName), React.createElement(\"div\", {\n        className: \"confirmation_btn_cont\"\n      }, React.createElement(Button, {\n        size: \"sm\",\n        onClick: this.onConfirmation,\n        color: \"secondary\"\n      }, \"No\"), React.createElement(Button, {\n        size: \"sm\",\n        onClick: this.rmFriend,\n        color: \"success\"\n      }, \"Si\"))))), React.createElement(Header, {\n        user: {\n          id: id,\n          perfilImg: perfilImg,\n          fullName: fullName,\n          frontPageImg: frontPageImg,\n          frontPageQuote: frontPageQuote,\n          friendReqSent: friendReqSent\n        },\n        owner: owner,\n        frontPageLoader: frontPageLoader,\n        perfilLoader: perfilLoader,\n        friendReqLoader: friendReqLoader,\n        action: {\n          onQuote: this.onQuote,\n          handleChangeImg: this.handleChangeImg,\n          onFriendReq: this.onFriendReq,\n          accpetFriend: this.accpetFriend,\n          cancelFriendReq: this.cancelFriendReq,\n          onConfirmation: this.onConfirmation\n        }\n      }), React.createElement(\"div\", {\n        className: \"void_space\"\n      }));\n    }\n  }]);\n\n  return Perfil;\n}(Component);\n\n_defineProperty(Perfil, \"getInitialProps\", function (_ref) {\n  var query = _ref.query;\n  var user = query.user;\n  return {\n    user: user\n  };\n});\n\nexport default Perfil;","map":{"version":3,"sources":["/media/felix/projects/green/pages/perf.jsx"],"names":["React","Component","Layout","Header","Quote","uuid","axios","Modal","ModalBody","Button","Perfil","props","state","id","perfilImg","perfilLoader","fullName","frontPageQuote","frontPageImg","frontPageLoader","quoteVisible","owner","friendReqLoader","friendReqSent","confirmationMsg","handleChange","bind","handleChangeImg","onQuote","onFriendReq","accpetFriend","cancelFriendReq","onConfirmation","rmFriend","user","name","lastName","setState","friend","console","log","e","target","value","img","files","formData","FormData","stateImg","loader","append","options","method","body","fetch","then","res","status","text","resp","targetId","get","response","query"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport Layout from '../components/layout/layout';\nimport './foo.scss';\nimport Header from '../components/perf/header';\nimport Quote from '../components/perf/quote';\nimport uuid from 'uuid/v1';\nimport axios from 'axios';\nimport { Modal, ModalBody, Button } from 'reactstrap';\n\nclass Perfil extends Component{\n  static getInitialProps = ({ query }) => {\n    const { user } = query;\n    return { user };\n  }\n\n  constructor(props){\n    super(props);\n    this.state = {\n      id: '',\n      perfilImg: '',\n      perfilLoader: false,\n      fullName: '',\n      frontPageQuote: '',\n      frontPageImg: '',\n      frontPageLoader: false,\n      quoteVisible: false,\n      owner: null,\n      friendReqLoader: false,\n      friendReqSent: '',\n      confirmationMsg: false,\n    }\n    this.handleChange = this.handleChange.bind(this);\n    this.handleChangeImg = this.handleChangeImg.bind(this);\n    this.onQuote = this.onQuote.bind(this);\n    this.onFriendReq = this.onFriendReq.bind(this);\n    this.accpetFriend = this.accpetFriend.bind(this);\n    this.cancelFriendReq = this.cancelFriendReq.bind(this);\n    this.onConfirmation = this.onConfirmation.bind(this);\n    this.rmFriend = this.rmFriend.bind(this);\n  }\n\n  componentWillMount(){\n    const { user } = this.props;\n    const fullName = `${user.name} ${user.lastName}`;\n    this.setState({\n      id: user.id,\n      perfilImg: user.perfilImg,\n      fullName,\n      frontPageQuote: user.frontPageQuote,\n      frontPageImg: user.frontPageImg,\n      owner: user.owner,\n      friendReqSent: user.friend,\n    })\n  }\n\n  componentDidMount() {\n    console.log(this.props.user);\n  }\n\n  handleChange(e) {\n    this.setState({ [e.target.id]: e.target.value });\n  }\n\n  handleChangeImg(e) {\n    const img = e.target.files[0];\n    const formData = new FormData();\n    const stateImg = `${e.target.id}Img`;\n    const loader = `${e.target.id}Loader`;\n    formData.append('file', img);\n    if(img) {\n      const options = {\n        method: \"POST\",\n        body: formData,\n      };\n      this.setState({ [loader]: true });\n      fetch(`/api/upload/${stateImg}`, options)\n        .then(res => {\n          if (res.status === 200) {\n            res.text()\n              .then(resp => {\n                this.setState({ [stateImg]: resp, [loader]: false  });\n              })\n          }\n        })\n    }\n  }\n\n  async accpetFriend(e){\n    this.setState({ friendReqLoader: true });\n    try{\n      const targetId = e.target.id;\n      await axios.get(`/aceptFriend/${targetId}`);\n      this.setState({ friendReqSent: 'accepted', friendReqLoader: false })\n    } catch(err) {\n      console.log(err);\n    }\n  }\n\n  onQuote() {\n    const { quoteVisible } = this.state;\n    this.setState({ quoteVisible: !quoteVisible });\n  }\n\n  async onFriendReq(e) {\n    this.setState({ friendReqLoader: true });\n    try{\n      const { id } = this.state ;\n      const response = await axios.get(`/sendFriendReq/${id}`);\n      this.setState({ friendReqLoader: false, friendReqSent: 'sent'  });\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  async cancelFriendReq() {\n    try{\n      const { id }  = this.state;\n      await axios.get(`/cancelFriendReq/${id}`);\n      this.setState({ friendReqSent: '' });\n    } catch(err) {\n      console.log(err);\n    }\n  }\n\n  onConfirmation() {\n    this.setState({ confirmationMsg: !this.state.confirmationMsg });\n  }\n\n  async rmFriend(){\n    try {\n      const { id } = this.state;\n      await axios.get(`/rmFriend/${id}`);\n      this.setState({ friendReqSent: '', confirmationMsg: !this.state.confirmationMsg });\n    } catch(err) {\n      console.log(err);\n    }\n  }\n\n  render() {\n    const {\n      id,\n      perfilImg,\n      perfilLoader,\n      fullName,\n      quoteVisible,\n      frontPageQuote,\n      frontPageImg,\n      frontPageLoader,\n      owner,\n      friendReqLoader,\n      friendReqSent,\n      confirmationMsg,\n    } = this.state;\n    return(\n      <Layout>\n        <Quote\n          isOpen={quoteVisible}\n          onQuote={this.onQuote}\n          handleChange={this.handleChange}\n          quote={frontPageQuote}\n          owner={owner}\n        />\n        <Modal isOpen={confirmationMsg}>\n          <ModalBody>\n            <div className=\"confirmation_cont\">\n              <p>Seguro que desea eliminar a {fullName}</p>\n              <div className=\"confirmation_btn_cont\">\n                <Button size=\"sm\" onClick={this.onConfirmation} color=\"secondary\">No</Button>\n                <Button size=\"sm\" onClick={this.rmFriend} color=\"success\">Si</Button>\n              </div>\n            </div>\n          </ModalBody>\n        </Modal>\n        <Header\n          user={{\n            id,\n            perfilImg,\n            fullName,\n            frontPageImg,\n            frontPageQuote,\n            friendReqSent,\n          }}\n          owner={owner}\n          frontPageLoader={frontPageLoader}\n          perfilLoader={perfilLoader}\n          friendReqLoader={friendReqLoader}\n          action={{\n            onQuote: this.onQuote,\n            handleChangeImg: this.handleChangeImg,\n            onFriendReq: this.onFriendReq,\n            accpetFriend: this.accpetFriend,\n            cancelFriendReq: this.cancelFriendReq,\n            onConfirmation: this.onConfirmation\n          }}\n        />\n        <div className=\"void_space\"></div>\n      </Layout>\n    );\n  }\n}\n\nexport default Perfil;\n"]},"metadata":{},"sourceType":"module"}